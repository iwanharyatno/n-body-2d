(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const n of s)if(n.type==="childList")for(const r of n.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&i(r)}).observe(document,{childList:!0,subtree:!0});function e(s){const n={};return s.integrity&&(n.integrity=s.integrity),s.referrerpolicy&&(n.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?n.credentials="include":s.crossorigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function i(s){if(s.ep)return;s.ep=!0;const n=e(s);fetch(s.href,n)}})();class u extends HTMLElement{constructor(){super()}connectedCallback(){this.render()}render(){this.innerHTML=`
    <nav class="shadow-md bg-blue-500 p-4 text-white d-flex justify-content-between font-bold ${this.getAttribute("class")}">
      <h1 class="text-2xl">N Body 2D</h1>
    </nav>
    `}}customElements.define("app-bar",u);class o{constructor(t=0,e=0){this.x=t,this.y=e}get magnitude(){return Math.sqrt(this.x*this.x+this.y*this.y)}get normalized(){return new o(this.x/this.magnitude,this.y/this.magnitude)}equals(t){return this.x==t.x&&this.y==t.y}add(t){this.x+=t.x,this.y+=t.y}distanceTo(t){const e=new o;return e.x=Math.abs(t.x-this.x),e.y=Math.abs(t.y-this.y),e.magnitude}multiplyScalar(t){this.x*=t,this.y*=t}}const l={G:66743e-15,massScale:1/1e15};function c(a=0,t=1){return Math.random()*(t-a)+a}function d(a){return l.massScale*a}class h{constructor(t){this.position=t!=null?t:new o,this.velocity=new o,this.mass=d(5972e21)}move(t=[]){this.position.add(this.velocity),this.potentialEnergy=0,t.forEach(e=>{if(this.position.equals(e.position)||this.position.distanceTo(e.position)<5)return;const i=this.position.distanceTo(e.position),s=new o(e.position.x-this.position.x,e.position.y-this.position.y).normalized,n=l.G*e.mass/(i*i);s.multiplyScalar(n),this.velocity.add(s),this.potentialEnergy+=-l.G*e.mass/i}),this.kineticEnergy=.5*this.mass*Math.pow(this.velocity.magnitude,2)}}class p extends HTMLElement{constructor(){super();const t=document.createElement("div");t.setAttribute("class","border border-slate-300 rounded p-4 m-5 max-w-md mx-auto"),this.canvas=document.createElement("canvas"),this.canvas.setAttribute("class","border mx-auto"),this.canvas.width=350,this.canvas.height=350,this.ctx=this.canvas.getContext("2d"),t.appendChild(this.canvas);const e=document.createElement("div");e.setAttribute("class","flex justify-evenly items-center w-full mt-4"),e.innerHTML=`
    <button type="button" class="py-2 px-4 rounded border-none bg-blue-500 text-white focus:bg-blue-700 w-1/3" id="replay-button">Run With</button>
    <input type="number" id="bodies-count" name="Bodies Count" aria-labelledby="replay-button" class="p-2 rounded border focus:outline focus:outline-blue-700 w-1/3" value="100">
    <span class="w-16">Bodies</span>
    `,t.appendChild(e),this.energyDisplay=document.createElement("div"),this.energyDisplay.setAttribute("class","grid grid-cols-2 gap-3 place-items-center p-4 mt-4"),t.appendChild(this.energyDisplay);const i=e.querySelector("#replay-button"),s=e.querySelector("#bodies-count");i.addEventListener("click",()=>this.generateBodies(s.value)),s.addEventListener("change",()=>this.generateBodies(s.value)),this.appendChild(t),this.canvasWidth=this.canvas.width,this.canvasHeight=this.canvas.height,this.generateBodies()}generateBodies(t=100){this.bodies=[];for(let e=0;e<t;e++){const i=new h;i.position.x=c(0,this.canvasWidth),i.position.y=c(0,this.canvasHeight),i.mass=c(d(7347e19),d(5972e21)),this.bodies.push(i)}}connectedCallback(){this.draw()}draw(){requestAnimationFrame(()=>this.draw()),this.ctx.fillStyle="#000000",this.ctx.fillRect(0,0,this.canvasWidth,this.canvasHeight);let t=0,e=0;for(const i of this.bodies)this.drawBody(i),i.move(this.bodies),t+=i.potentialEnergy,e+=i.kineticEnergy;e=Math.round(e/1e9),t=Math.round(t),this.energyDisplay.innerHTML=`
    <div class="font-bold">KE</div>
    <div>${e}</div>
    <div class="font-bold">PE</div>
    <div>${t}</div>
    <div class="font-bold">Total</div>
    <div>${e+t}</div>
    `}drawBody(t){this.ctx.fillStyle="#ffffff",this.ctx.beginPath(),this.ctx.arc(t.position.x,t.position.y,2,0,2*Math.PI),this.ctx.fill()}}customElements.define("n-body-simulation",p);document.querySelector("#app").innerHTML=`
<app-bar class="mb-3"></app-bar>
<main class="p-3">
  <n-body-simulation></n-body-simulation>
</main>
`;
